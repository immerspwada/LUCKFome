<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div style="text-align:center; margin: 18px 0 0 0; color: #ff8800; font-size: 1.2rem; font-weight: bold; letter-spacing: 1px;">‡∏£‡πâ‡∏≤‡∏ô LUCKY KOLOK</div>
    <h2>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
    <div class="payment-box">
      <h2>‡∏™‡πÅ‡∏Å‡∏ô‡∏õ‡∏∏‡πä‡∏ö ‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏±‡πä‡∏ö üê±üí∏</h2>
      <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> ‡∏°‡∏µ‡∏ô‡∏£‡∏ç‡∏≤‡∏ì‡πå ‡∏û‡∏£‡∏´‡∏°‡πÄ‡∏û‡∏ä‡∏£</p>
      <p><strong>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> 720-1-11288-5</p>
      <p><strong>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</strong> ‡∏Å‡∏£‡∏∏‡∏á‡∏®‡∏£‡∏µ (Krungsri)</p>
      <img src="qr-code-image.png" alt="QR ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå" width="200" onerror="this.style.display='none';document.getElementById('qr-error').style.display='block';">
      <div id="qr-error" style="display:none;color:#ff3b30;font-weight:bold;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå QR ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå!</div>
      <p>üì± <strong>PromptPay</strong> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</p>
      <p>üôè <strong>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</strong> ‚Äî Thank you</p>
    </div>
    <div style="margin:24px 0 12px 0;">
      <label style="font-weight:500;">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:
        <input type="file" id="slip-input" accept="image/*" style="margin-top:8px;">
      </label>
      <div id="slip-preview-box" style="margin-top:10px;display:none;">
        <img id="slip-preview" src="" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏•‡∏¥‡∏õ" style="max-width:220px;max-height:220px;border-radius:10px;border:1.5px solid #ffb347;box-shadow:0 2px 8px rgba(255,136,0,0.10);">
      </div>
    </div>
    <button id="notify-btn" style="margin-top:18px;background:linear-gradient(90deg,#ff8800 60%,#ffb347 100%);color:#fff;border:none;border-radius:12px;padding:14px 40px;font-size:1.15rem;font-weight:600;cursor:pointer;box-shadow:0 2px 12px rgba(255,136,0,0.13);">‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
    <button id="back-btn" style="margin-top:12px;">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
    <script>
      document.getElementById('back-btn').onclick = function() {
        window.location.href = 'cart.html';
      };
      // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏•‡∏¥‡∏õ
      document.getElementById('slip-input').onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(evt) {
            document.getElementById('slip-preview').src = evt.target.result;
            document.getElementById('slip-preview-box').style.display = 'block';
          };
          reader.readAsDataURL(file);
        } else {
          document.getElementById('slip-preview-box').style.display = 'none';
        }
      };
      document.getElementById('notify-btn').onclick = async function() {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        if (cart.length === 0) {
          alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå');
          return;
        }
        let summary = '‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô\n';
        cart.forEach(item => {
          summary += `${item.name} x${item.qty} = ${item.price * item.qty} ‡∏ö‡∏≤‡∏ó\n`;
        });
        summary += `‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${cart.reduce((sum, item) => sum + item.price * item.qty, 0)} ‡∏ö‡∏≤‡∏ó\n`;
        summary += '\n‡πÇ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ‡∏°‡∏µ‡∏ô‡∏£‡∏ç‡∏≤‡∏ì‡πå ‡∏û‡∏£‡∏´‡∏°‡πÄ‡∏û‡∏ä‡∏£\n‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: 720-1-11288-5 (‡∏Å‡∏£‡∏∏‡∏á‡∏®‡∏£‡∏µ)';
        // ‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏õ‡πá‡∏ô base64 (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        const slipInput = document.getElementById('slip-input');
        const slipFile = slipInput.files[0];
        if (slipFile) {
          const reader = new FileReader();
          reader.onload = async function(evt) {
            const slipBase64 = evt.target.result;
            if (window.liff) {
              await liff.init({ liffId: '2006986568-yjrOkKqm' });
              await liff.sendMessages([
                { type: 'text', text: summary },
                { type: 'image', originalContentUrl: slipBase64, previewImageUrl: slipBase64 }
              ]);
              alert('‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
              liff.closeWindow();
            } else {
              alert(summary + '\n(‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå)');
            }
          };
          reader.readAsDataURL(slipFile);
        } else {
          if (window.liff) {
            await liff.init({ liffId: '2006986568-yjrOkKqm' });
            await liff.sendMessages([{ type: 'text', text: summary }]);
            alert('‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
            liff.closeWindow();
          } else {
            alert(summary);
          }
        }
      };
    </script>
</body>
</html>
